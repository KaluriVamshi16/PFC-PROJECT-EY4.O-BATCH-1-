{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Financial Dashboard | FinSight</title>

<style>
    body{
        margin:0;
        font-family:'Segoe UI', sans-serif;
        background: linear-gradient(135deg,#0f2027,#203a43,#2c5364);
        color:#fff;
    }

    .container{
        padding:40px;
        animation: fadeIn 0.6s ease-in-out;
    }

    h1{
        font-size:32px;
        margin-bottom:30px;
        font-weight:600;
    }

    .cards{
        display:grid;
        grid-template-columns: repeat(auto-fit, minmax(250px,1fr));
        gap:20px;
        margin-bottom:40px;
    }

    .card{
        background: rgba(255,255,255,0.08);
        backdrop-filter: blur(12px);
        padding:25px;
        border-radius:16px;
        box-shadow:0 10px 30px rgba(0,0,0,0.4);
        transition:0.3s;
    }

    .card:hover{
        transform: translateY(-5px);
        box-shadow:0 15px 40px rgba(0,0,0,0.6);
    }

    .card h3{
        font-size:18px;
        margin-bottom:10px;
        font-weight:500;
        opacity:0.9;
    }

    .card p{
        font-size:24px;
        font-weight:600;
    }

    .back-btn{
        display:inline-block;
        margin-bottom:20px;
        padding:8px 16px;
        background: rgba(255,255,255,0.15);
        border-radius:6px;
        text-decoration:none;
        color:#fff;
        transition:0.3s;
    }

    .back-btn:hover{
        background: rgba(255,255,255,0.3);
    }

    /* Table */
    table{
        width:100%;
        border-collapse: collapse;
        border-radius:12px;
        overflow:hidden;
        background: rgba(255,255,255,0.08);
        backdrop-filter: blur(10px);
    }

    th, td{
        padding:15px;
        text-align:left;
    }

    th{
        background: rgba(0,0,0,0.4);
        font-weight:600;
    }

    tr{
        transition:0.3s;
    }

    tr:hover{
        background: rgba(255,255,255,0.1);
    }

    @keyframes fadeIn{
        from{opacity:0; transform:translateY(20px);}
        to{opacity:1; transform:translateY(0);}
    }

</style>

</head>

<body>

<div class="container">

    <a href="{% url 'dashboard' %}" class="back-btn">â¬… Back to Dashboard</a>

    <h1>ðŸ“Š Financial Dashboard</h1>

    <!-- Summary Cards -->
    <div class="cards">

        <div class="card">
            <h3>Total Expense</h3>
            <p>â‚¹ {{ total_expense }}</p>
        </div>

        <div class="card">
            <h3>This Month</h3>
            <p>â‚¹ {{ monthly_expense }}</p>
        </div>

        <div class="card">
            <h3>Total Transactions</h3>
            <p>{{ expense_count }}</p>
        </div>

    </div>

    <!-- Recent Transactions -->
    <h2>Recent Transactions</h2>

    <table>
        <tr>
            <th>Title</th>
            <th>Amount</th>
            <th>Category</th>
            <th>Date</th>
        </tr>

        {% for expense in recent_expenses %}
        <tr>
            <td>{{ expense.title }}</td>
            <td>â‚¹ {{ expense.amount }}</td>
            <td>{{ expense.category }}</td>
            <td>{{ expense.date }}</td>
        </tr>
        {% empty %}
        <tr>
            <td colspan="4">No transactions available.</td>
        </tr>
        {% endfor %}

    </table>

</div>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<div style="width: 45%; margin: 40px auto;">
    <h2 style="text-align:center;">Expense Distribution</h2>
    <canvas id="expenseChart"></canvas>
</div>

<script>
    const ctx = document.getElementById('expenseChart').getContext('2d');

    const expenseChart = new Chart(ctx, {
        type: 'pie',
        data: {
            labels: {{ categories|safe }},
            datasets: [{
                data: {{ totals|safe }},
                backgroundColor: [
                    '#4e73df',
                    '#1cc88a',
                    '#36b9cc',
                    '#f6c23e',
                    '#e74a3b',
                    '#858796',
                    '#fd7e14'
                ],
                borderWidth: 1
            }]
        },
        options: {
            responsive: true,
            plugins: {
                legend: {
                    position: 'bottom'
                }
            }
        }
    });
</script>
</body>
</html>
